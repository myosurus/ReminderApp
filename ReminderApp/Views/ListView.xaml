<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
	xmlns:xct="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:ReminderApp.ViewModels"
    x:Class="ReminderApp.Views.ListView"
    Title="Ð—Ð°Ð´Ð°Ñ‡Ð¸"
    BackgroundColor="#F7EAFB">

	<ContentPage.BindingContext>
		<vm:ListViewModel />
	</ContentPage.BindingContext>

	<Grid Padding="20">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<VerticalStackLayout Grid.Row="0" Spacing="2">
			<Label Text="ðŸ”” ÐÐ°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ð¾ Ð·Ð°Ð´Ð°Ñ‡Ð°Ñ…"
                   FontAttributes="Bold"
                   FontSize="14"
                   TextColor="#333"/>
			<Label Text="ÐÐµ ÑƒÐ¿ÑƒÑÐºÐ°Ð¹Ñ‚Ðµ Ð²Ð°Ð¶Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸"
                   FontSize="12"
                   TextColor="#777"/>
		</VerticalStackLayout>

		<CollectionView Grid.Row="1"
                        x:Name="RemindersCollectionView"
                        ItemsSource="{Binding Reminders}"
                        SelectionMode="Single"
                        SelectedItem="{Binding SelectedReminder, Mode=TwoWay}">

			<CollectionView.EmptyView>
				<VerticalStackLayout 
                    VerticalOptions="CenterAndExpand"
                    HorizontalOptions="CenterAndExpand"
                    Spacing="10">
					<Image Source="clock_icon.png"
                           HeightRequest="50"
                           WidthRequest="50"
                           Aspect="AspectFit"/>
					<Label Text="Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹"
                           FontAttributes="Bold"
                           FontSize="14"
                           TextColor="#777"
                           HorizontalTextAlignment="Center"/>
					<Label Text="Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð·Ð°Ð´Ð°Ñ‡Ñƒ"
                           FontSize="12"
                           TextColor="#999"
                           HorizontalTextAlignment="Center"/>
				</VerticalStackLayout>
			</CollectionView.EmptyView>

			<CollectionView.ItemTemplate>
				<DataTemplate>
					<Grid Padding="15,10" 
                          ColumnDefinitions="Auto,*,Auto,Auto"
                          BackgroundColor="#FDFCFD"
                          Margin="0,1">

						<Frame Grid.Column="0"
                               BackgroundColor="{Binding UrgencyColor}"
                               HeightRequest="12"
                               WidthRequest="12"
                               Padding="0"
                               HasShadow="False"
                               CornerRadius="6"
                               VerticalOptions="Center"/>

						<VerticalStackLayout Grid.Column="1" Spacing="2" Margin="10,0">
							<Label Text="{Binding Name}"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   TextColor="#333"/>
							<Label Text="{Binding Description}"
                                   FontSize="12"
                                   TextColor="#666"
                                   LineBreakMode="TailTruncation"
                                   MaxLines="1"/>
							<Label Text="{Binding ReminderDate, StringFormat='{0:dd.MM.yyyy HH:mm}'}"
                                   FontSize="11"
                                   TextColor="#999"/>
						</VerticalStackLayout>

						<CheckBox Grid.Column="2"
                                  IsChecked="{Binding IsDone}"
                                  VerticalOptions="Center"
                                  Margin="10,0">
							<CheckBox.Behaviors>
								<xct:EventToCommandBehavior
                                    EventName="CheckedChanged"
                                    Command="{Binding Source={x:Reference RemindersCollectionView}, Path=BindingContext.CheckBoxCheckedCommand}"
                                    CommandParameter="{Binding .}" />
							</CheckBox.Behaviors>
						</CheckBox>

						<Frame Grid.Column="3"
                               BackgroundColor="{Binding OverdueColor}"
                               HeightRequest="8"
                               WidthRequest="8"
                               Padding="0"
                               HasShadow="False"
                               CornerRadius="4"
                               VerticalOptions="Center"
                               IsVisible="{Binding IsOverdue}"/>
					</Grid>
				</DataTemplate>
			</CollectionView.ItemTemplate>
		</CollectionView>

	</Grid>
</ContentPage>
